<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="Stefan van den Oord">
<title>Strohm Native Tutorial: Yet Another Weather Nicety</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
<link rel="stylesheet" href="style.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Strohm Native Tutorial: Yet Another Weather Nicety</h1>
<div class="details">
<span id="author" class="author">Stefan van den Oord</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_prerequisites">2. Prerequisites</a></li>
<li><a href="#_development_environment">3. Development Environment</a></li>
<li><a href="#_setup_a_new_project">4. Setup a New Project</a>
<ul class="sectlevel2">
<li><a href="#_common_code">4.1. Common Code</a>
<ul class="sectlevel3">
<li><a href="#_hot_reloading">4.1.1. Hot Reloading</a></li>
</ul>
</li>
<li><a href="#_android">4.2. Android</a>
<ul class="sectlevel3">
<li><a href="#_create_project">4.2.1. Create Project</a></li>
<li><a href="#_add_dependency">4.2.2. Add Dependency</a></li>
<li><a href="#_setup_strohm_native">4.2.3. Setup Strohm Native</a></li>
<li><a href="#_network_security_config">4.2.4. Network Security Config</a></li>
<li><a href="#_running">4.2.5. Running</a></li>
</ul>
</li>
<li><a href="#_ios">4.3. iOS</a>
<ul class="sectlevel3">
<li><a href="#_create_project_2">4.3.1. Create Project</a></li>
<li><a href="#_add_dependency_2">4.3.2. Add Dependency</a></li>
<li><a href="#_setup_strohm_native_2">4.3.3. Setup Strohm Native</a></li>
<li><a href="#_allow_local_networking">4.3.4. Allow Local Networking</a></li>
<li><a href="#_add_compiled_javascript">4.3.5. Add Compiled JavaScript</a></li>
<li><a href="#_running_on_simulator">4.3.6. Running on Simulator</a></li>
<li><a href="#_running_on_device">4.3.7. Running on Device</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a><a class="link" href="#_introduction">1. Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial explains how to set up a new Strohm Native project.
To make things more explicit and easier to talk about, let&#8217;s say the app we&#8217;re
going to setup is <strong>Yawn: Yet Another Weather Nicety</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Whenever I mention the <strong>root folder</strong>, I mean the folder that contains your
project. The one in which you do <code>git init</code>. For example, it could be
<code>~/Documents/Yawn</code>. Unless stated otherwise, all paths are relative to that root
folder. So given that project location, the path <code>/src</code> is in fact
<code>~/Documents/Yawn/src</code>. Also, my examples assume that you&#8217;re using a Unix/macOS
like operating system. I&#8217;m assuming experienced Windows users will be able to
read the examples and figure out the corresponding actions on Windows themselves.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Strap in, here we go.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a><a class="link" href="#_prerequisites">2. Prerequisites</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using Strohm, you or your team needs to be able to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Develop native iOS apps (using <a href="https://swift.org">Swift</a> typically),</p>
</li>
<li>
<p>Develop native Android apps (using <a href="https://kotlinlang.org">Kotlin</a> typically), and</p>
</li>
<li>
<p>Use <a href="https://clojurescript.org">ClojureScript</a> for the common code<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note that that this is only two big platforms that you have to
understand, instead of the three that you need for popular cross-platform
frameworks like <a href="https://reactnative.dev">React Native</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development_environment"><a class="anchor" href="#_development_environment"></a><a class="link" href="#_development_environment">3. Development Environment</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A full development environment consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.apple.com/xcode/">Xcode</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio/">Android Studio</a> (including SDK and emulator)</p>
</li>
<li>
<p>Your favorite Clojure(Script) editor (I&#8217;m using <a href="https://code.visualstudio.com">VSCode</a> and
<a href="https://calva.io">Calva</a>)</p>
</li>
<li>
<p><a href="https://nodejs.org/en/">NodeJS</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the moment I&#8217;m using Xcode 12.5, Android Studio 2020.3, NodeJS 14, and Yarn
1.22.10.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_a_new_project"><a class="anchor" href="#_setup_a_new_project"></a><a class="link" href="#_setup_a_new_project">4. Setup a New Project</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Setting up your project breaks down into three parts: setup the common
ClojureScript side, setup the Android project, and setup the iOS project.</p>
</div>
<div class="paragraph">
<p>But first of course we create the root folder of our project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir ~/Documents/Yawn
cd ~/Documents/Yawn
git init</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_common_code"><a class="anchor" href="#_common_code"></a><a class="link" href="#_common_code">4.1. Common Code</a></h3>
<div class="paragraph">
<p>The common (ClojureScript) code is built and developed using
<a href="https://shadow-cljs.github.io/docs/UsersGuide.html"><code>shadow-cljs</code></a>. We&#8217;re going to setup a pretty straight-forward
<code>shadow-cljs</code> project. Hence we need a <code>package.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "Yawn",
  "version": "1.0.0",
  "description": "Yet Another Weather Nicety is a less than exciting weather app",
  "main": "index.js",
  "devDependencies": {
    "shadow-cljs": "^2.15.5"
  },
  "scripts": {
    "watch": "shadow-cljs watch :app :test",
    "release": "shadow-cljs release :app"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn</code></pre>
</div>
</div>
<div class="paragraph">
<p>For our ClojureScript code, <code>shadow-cljs</code> needs a build config file as well,
named <code>shadow-cljs.edn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-clojure hljs" data-lang="clojure">{:source-paths ["src" "test"]

 :dependencies
 [[dev.strohmnative/strohm-native "0.1.0-SNAPSHOT"]] ;; replace with latest version

 :dev-http {8080  "target/"}

 :builds
 {:app {:output-dir "target/"
        :target :browser
        :asset-path "."
        :modules {:main {:entries [app.main]
                         :init-fn app.main/main!}}}
   :test {:target :node-test
          :output-to "target/node-test.js"
          :ns-regexp "-test$"
          :autorun true
          :compiler-options {:reader-features #{:test}}}}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create the main source code file <code>/src/app/main.cljs</code> and put this in it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-clojure hljs" data-lang="clojure">(ns app.main
  (:require [strohm-native.flow :refer [create-store]]))

;; Reducer doesn't do anything yet, simply returns state
(defn reducer [state _action] state)

(defn ^:export main! []
  (tap&gt; "Hello world!")
  (create-store reducer :initial-state {:greeting "Hello world!"}))

(defn ^:dev/after-load reload! []
  (tap&gt; "reloaded"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>That code is pretty much the minimum you need: create a store with some initial
state, and create the root reducer. The reducer doesn&#8217;t do anything yet, we&#8217;ll
get to that later.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll also create a HTML file so that we can easily load the compiled JS into a
browser. In <code>/target/index.html</code>, put this HTML source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;script src="main.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    Yawn!
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This puts all the basics in place. We can now run <code>shadow-cljs</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn shadow-cljs watch :app
shadow-cljs - config: [path]/Documents/Yawn/shadow-cljs.edn
shadow-cljs - HTTP server available at http://localhost:8080
shadow-cljs - server version: 2.15.5 running at http://localhost:9630
shadow-cljs - nREPL server started on port 56827
shadow-cljs - watching build :app
[:app] Configuring build.
[:app] Compiling ...
[:app] Build completed. (119 files, 0 compiled, 0 warnings, 2,30s)</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you now browse to <code><a href="http://localhost:9630" class="bare">http://localhost:9630</a></code> you should see the <code>shadow-cljs</code>
dashboard. There should be one active HTTP server on <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code>.
When you click that link, a new browser tab opens that says "Yawn!". Going back
to the <code>shadow-cljs</code> dashboard, in the "Inspect Stream" tab you should see the
text "Hello world!" that was tapped in <code>main.cljs</code>.</p>
</div>
<div class="sect3">
<h4 id="_hot_reloading"><a class="anchor" href="#_hot_reloading"></a><a class="link" href="#_hot_reloading">4.1.1. Hot Reloading</a></h4>
<div class="paragraph">
<p><code>shadow-cljs</code> comes with hot reloading out of the box. So for the final touch in
this section, add the following function to your <code>main.cljs</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-clojure hljs" data-lang="clojure">(defn ^:dev/after-load reload! []
  (tap&gt; "reloaded"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, while having the tab with <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code> open, save the file. You
should now see "reloaded" appear in the <code>shadow-cljs</code> dashboard&#8217;s Tap History
(Inspect Stream). In other words: <code>shadow-cljs</code> has hot reloaded the code and it
has called the hook <code>reload!</code> afterwards.</p>
</div>
<div class="paragraph text-center">
<p><span class="big large-emoticon">ðŸŽ‰</span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_android"><a class="anchor" href="#_android"></a><a class="link" href="#_android">4.2. Android</a></h3>
<div class="sect3">
<h4 id="_create_project"><a class="anchor" href="#_create_project"></a><a class="link" href="#_create_project">4.2.1. Create Project</a></h4>
<div class="paragraph">
<p>Using Android Studio, create a new Android project in the folder <code>/android</code>.
Make sure to run the empty project, because this is a good time to fix potential
issues around Java versions and the like.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_dependency"><a class="anchor" href="#_add_dependency"></a><a class="link" href="#_add_dependency">4.2.2. Add Dependency</a></h4>
<div class="paragraph">
<p>In your app&#8217;s <code>build.gradle</code> file, add the Strohm Native for Android dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">ext {
    strohmNativeVersion = '0.1.0-SNAPSHOT' // replace with latest version
}

dependencies {
    [...]
    debugImplementation "dev.strohmnative:strohm-native-android-debug:$strohmNativeVersion"
    releaseImplementation "dev.strohmnative:strohm-native-android:$strohmNativeVersion"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pick the latest released version of course.</p>
</div>
</div>
<div class="sect3">
<h4 id="_setup_strohm_native"><a class="anchor" href="#_setup_strohm_native"></a><a class="link" href="#_setup_strohm_native">4.2.3. Setup Strohm Native</a></h4>
<div class="paragraph">
<p>A good way of setting up Strohm Native for Android, is to put it in your own
<code>Application</code> subclass. For this to work, you create the <code>YawnApplication</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">package dev.strohmnative.examples.yawn

import android.app.Application
import dev.strohmnative.StrohmNative

class YawnApplication: Application() {
    lateinit var strohmNative: StrohmNative

    override fun onCreate() {
        super.onCreate()
        strohmNative = StrohmNative.getInstance(applicationContext)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you need to tell Android to use an instance of this class by configuring
your application in <code>AndroidManifest.xml</code>. Add the attribute <code>android:name</code> like
so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="dev.strohmnative.examples.yawn"&gt;

    &lt;application
        android:name="dev.strohmnative.examples.yawn.YawnApplication"
        ... &gt;
    &lt;/application&gt;
&lt;/manifest&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_network_security_config"><a class="anchor" href="#_network_security_config"></a><a class="link" href="#_network_security_config">4.2.4. Network Security Config</a></h4>
<div class="paragraph">
<p>During development, the app needs to be able to connect to <code>localhost</code>, namely
to communicate with shadow-cljs and the REPL. By default, this is not allowed,
so you have to configure this. In <code>res/xml</code>, add the file
<code>network_security_config.xml</code> with the following contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;network-security-config&gt;
    &lt;domain-config cleartextTrafficPermitted="true"&gt;
        &lt;domain includeSubdomains="false"&gt;localhost&lt;/domain&gt;
    &lt;/domain-config&gt;
&lt;/network-security-config&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then refer to this file from your <code>AndroidManifest.xml</code> by adding the
<code>android:networkSecurityConfig</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="dev.strohmnative.examples.yawn"&gt;

    &lt;application
        android:name="dev.strohmnative.examples.yawn.YawnApplication"
        android:networkSecurityConfig="@xml/network_security_config"
        ... &gt;
    &lt;/application&gt;
&lt;/manifest&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that you can limit this to your Debug configuration if desired.</p>
</div>
</div>
<div class="sect3">
<h4 id="_running"><a class="anchor" href="#_running"></a><a class="link" href="#_running">4.2.5. Running</a></h4>
<div class="paragraph">
<p>Your app needs to be able to contact the <code>shadow-cljs</code> server and vice versa, so
we need to configure ADB reverse port forwarding. Since we&#8217;ll be doing that many
times, let&#8217;s add a script to our <code>package.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  ...
  "scripts": {
    ...
    "adb-reverse": "adb reverse tcp:8080 tcp:8080 &amp;&amp; adb reverse tcp:9630 tcp:9630"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can run your app:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure shadow-cljs is running the <code>:app</code> build, either by running <code>yarn
watch</code> or by jacking-in from your favorite Clojure editor.</p>
</li>
<li>
<p>Make sure the Android simulator is running or your device is connected, and
run <code>yarn adb-reverse</code> to activate reverse port forwarding.</p>
</li>
<li>
<p>Run the app from Android Studio.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If everything is well, you should see a log message in Android Studio&#8217;s "Run"
tab where shadow-cljs says that it is ready.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ios"><a class="anchor" href="#_ios"></a><a class="link" href="#_ios">4.3. iOS</a></h3>
<div class="sect3">
<h4 id="_create_project_2"><a class="anchor" href="#_create_project_2"></a><a class="link" href="#_create_project_2">4.3.1. Create Project</a></h4>
<div class="paragraph">
<p>Create a new project in Xcode, using SwiftUI and Swift.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_dependency_2"><a class="anchor" href="#_add_dependency_2"></a><a class="link" href="#_add_dependency_2">4.3.2. Add Dependency</a></h4>
<div class="paragraph">
<p>Then add Stohm Native as a Swift package dependency in the project settings, by
pointing Xcode to <code><a href="https://github.com/StrohmNative/strohm-native" class="bare">https://github.com/StrohmNative/strohm-native</a></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_setup_strohm_native_2"><a class="anchor" href="#_setup_strohm_native_2"></a><a class="link" href="#_setup_strohm_native_2">4.3.3. Setup Strohm Native</a></h4>
<div class="paragraph">
<p>Now open the Swift file containing your <code>App</code> instance, <code>YawnApp</code> in this
example. It is the file that contains the <code>@main</code> annotation. Modify it like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">import SwiftUI
import StrohmNative <i class="conum" data-value="1"></i><b>(1)</b>

@main
struct YawnApp: App {
    let strohmNative = StrohmNative.default <i class="conum" data-value="2"></i><b>(2)</b>

    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import Strohm Native</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add a reference to <code>StrohmNative.default</code></td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_allow_local_networking"><a class="anchor" href="#_allow_local_networking"></a><a class="link" href="#_allow_local_networking">4.3.4. Allow Local Networking</a></h4>
<div class="paragraph">
<p>Just like on Android, the app needs to be able to use local networking during
development. In your app&#8217;s info properties, add the section "App Transport
Security Settings", and inside of it the setting "Allows Local Networking". Set
the value to <code>YES</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/img/info_plist.png" alt="Info property list">
</div>
</div>
<div class="paragraph">
<p>Note that you can limit this to your Debug configuration if desired, by setting
the value here to a custom variable, e.g. <code>$(ALLOW_LOCAL_NETWORKING)</code>. In your
build settings you can then set the value of that variable to <code>YES</code> and <code>NO</code>
depending on the build configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_compiled_javascript"><a class="anchor" href="#_add_compiled_javascript"></a><a class="link" href="#_add_compiled_javascript">4.3.5. Add Compiled JavaScript</a></h4>
<div class="paragraph">
<p>In order for Xcode to include the compiled JavaScript in your project, you need
to add it manually. Just drag-and-drop the file <code>target/main.js</code> into your
project and make sure the checkbox indicating the file needs to be included in
the target is checked. Also, don&#8217;t allow Xcode to copy the file, just add a
reference.</p>
</div>
</div>
<div class="sect3">
<h4 id="_running_on_simulator"><a class="anchor" href="#_running_on_simulator"></a><a class="link" href="#_running_on_simulator">4.3.6. Running on Simulator</a></h4>
<div class="paragraph">
<p>You can now run your app on a simulator. Just like on Android, shadow-cljs will
report to the JavaScript console that it is ready. Unfortunately, you cannot see
this as you can only open the console (using Safari&#8217;s develop menu) <em>after</em> this
line has been logged, so it has been lost. Rest assured though: when you don&#8217;t
see any errors in Xcode&#8217;s debug area, everything should be fine.</p>
</div>
<div class="paragraph">
<p>In shadow-cljs' [Inspect Stream](<a href="http://localhost:9630/inspect" class="bare">http://localhost:9630/inspect</a>) you should now
see the text "Hello world!" that was tapped in the clojure code.</p>
</div>
</div>
<div class="sect3">
<h4 id="_running_on_device"><a class="anchor" href="#_running_on_device"></a><a class="link" href="#_running_on_device">4.3.7. Running on Device</a></h4>
<div class="paragraph">
<p>When running on device, a bit more setup is needed, because your app needs to
know the hostname of your development machine, so that it can connect to
shadow-cljs. The following simple "Run Script Phase" takes care of that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">hostname -s &gt; ${CODESIGNING_FOLDER_PATH}/devhost.txt</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/img/devhost.png" alt="Dev host run script phase">
</div>
</div>
<div class="paragraph">
<p>This simply captures your IP address in a file, which is then used during
development to connect to that shadow-cljs running on that IP address.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Clojure(Script) is just the language that I happen to use most at the moment. In principle, any language that compiles to JavaScript can be used instead. The common part of Strohm of course has to be rewritten in that language in that case, but it is really not a lot of code. I&#8217;m not planning to port it to another language any time soon.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-10-20 13:53:01 +0200
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/clojure.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/languages/swift.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</body>
</html>